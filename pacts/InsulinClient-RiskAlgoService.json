{
  "consumer": {
    "name": "InsulinClient"
  },
  "interactions": [
    {
      "description": "a basal adjustment request",
      "providerStates": [
        {
          "name": "a patient with valid glucose readings and basal rate"
        }
      ],
      "request": {
        "body": {
          "current_basal_rate": 10,
          "glucose_readings": [
            100,
            100,
            100,
            100,
            100,
            100
          ],
          "patient_id": "patient-123"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.current_basal_rate": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.glucose_readings": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type",
                  "min": 6
                }
              ]
            },
            "$.glucose_readings[*]": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                },
                {
                  "match": "number"
                },
                {
                  "match": "number"
                },
                {
                  "match": "number"
                },
                {
                  "match": "number"
                },
                {
                  "match": "number"
                }
              ]
            },
            "$.patient_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          }
        },
        "method": "POST",
        "path": "/calculate/basal-adjustment"
      },
      "response": {
        "body": {
          "action": "maintain",
          "adjusted_basal_rate": 10,
          "adjustment_percentage": 0,
          "patient_id": "patient-123",
          "trend": "stable"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.action": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.adjusted_basal_rate": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.adjustment_percentage": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.patient_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.trend": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          }
        },
        "status": 200
      }
    },
    {
      "description": "a bolus calculation request",
      "providerStates": [
        {
          "name": "a patient with valid glucose and carb data"
        }
      ],
      "request": {
        "body": {
          "carbs_grams": 30,
          "current_glucose_mg_dl": 150,
          "insulin_on_board_units": 5,
          "patient_id": "patient-123"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.carbs_grams": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.current_glucose_mg_dl": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.insulin_on_board_units": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.patient_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          }
        },
        "method": "POST",
        "path": "/calculate/bolus"
      },
      "response": {
        "body": {
          "carb_coverage_units": 3,
          "correction_units": 5,
          "patient_id": "patient-123",
          "recommended_bolus_units": 10,
          "risk_level": "low",
          "warnings": []
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.carb_coverage_units": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.correction_units": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.patient_id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.recommended_bolus_units": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "number"
                }
              ]
            },
            "$.risk_level": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.warnings": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type",
                  "min": 0
                }
              ]
            }
          }
        },
        "status": 200
      }
    },
    {
      "description": "a health check request",
      "providerStates": [
        {
          "name": "the service is healthy"
        }
      ],
      "request": {
        "method": "GET",
        "path": "/health"
      },
      "response": {
        "body": {
          "service": "RiskAlgoService",
          "status": "healthy",
          "version": "1.0.0"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.service": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.status": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.version": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          }
        },
        "status": 200
      }
    }
  ],
  "metadata": {
    "pact-js": {
      "version": "16.0.4"
    },
    "pactRust": {
      "ffi": "0.4.28",
      "models": "1.3.5"
    },
    "pactSpecification": {
      "version": "3.0.0"
    }
  },
  "provider": {
    "name": "RiskAlgoService"
  }
}